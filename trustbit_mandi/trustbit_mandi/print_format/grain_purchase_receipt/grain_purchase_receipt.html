<style>
	.gp-receipt {
		font-family: Arial, sans-serif;
		font-size: 13px;
		padding: 15px;
		max-width: 800px;
		margin: 0 auto;
	}
	.gp-receipt .header {
		text-align: center;
		border-bottom: 3px double #000;
		padding-bottom: 10px;
		margin-bottom: 15px;
	}
	.gp-receipt .header h2 {
		margin: 0;
		font-size: 20px;
		font-weight: bold;
		letter-spacing: 1px;
	}
	.gp-receipt .header h4 {
		margin: 5px 0 0 0;
		font-size: 14px;
		font-weight: normal;
		color: #555;
	}
	.gp-receipt .doc-meta {
		display: flex;
		justify-content: space-between;
		margin-bottom: 10px;
		font-size: 12px;
		color: #666;
	}
	.gp-receipt table {
		width: 100%;
		border-collapse: collapse;
		margin-bottom: 12px;
	}
	.gp-receipt table td {
		padding: 6px 10px;
		border: 1px solid #333;
		vertical-align: top;
	}
	.gp-receipt table td.label-cell {
		font-weight: bold;
		width: 25%;
		background: #f5f5f5;
		font-size: 12px;
	}
	.gp-receipt table td.value-cell {
		width: 25%;
	}
	.gp-receipt .section-title {
		font-size: 14px;
		font-weight: bold;
		background: #333;
		color: #fff;
		padding: 5px 10px;
		margin: 12px 0 0 0;
	}
	.gp-receipt .amount-box {
		border: 2px solid #000;
		padding: 12px;
		margin: 12px 0;
		text-align: center;
	}
	.gp-receipt .amount-box .label {
		font-size: 12px;
		color: #666;
	}
	.gp-receipt .amount-box .value {
		font-size: 22px;
		font-weight: bold;
	}
	.gp-receipt .payment-status {
		display: inline-block;
		padding: 3px 12px;
		border-radius: 4px;
		font-weight: bold;
		font-size: 12px;
	}
	.gp-receipt .status-paid { background: #d4edda; color: #155724; }
	.gp-receipt .status-pending { background: #fff3cd; color: #856404; }
	.gp-receipt .status-partial { background: #cce5ff; color: #004085; }
	.gp-receipt .status-cancelled { background: #f8d7da; color: #721c24; }
	.gp-receipt .signature-section {
		margin-top: 40px;
		display: flex;
		justify-content: space-between;
	}
	.gp-receipt .signature-box {
		width: 30%;
		text-align: center;
		border-top: 1px solid #000;
		padding-top: 5px;
		font-size: 11px;
	}
	.gp-receipt .two-col {
		display: flex;
		gap: 12px;
	}
	.gp-receipt .two-col .col {
		flex: 1;
	}
	.gp-receipt .two-col table {
		margin-bottom: 0;
	}
</style>

<div class="gp-receipt">
	<div class="header">
		<h2>KRISHI UPAJ MANDI SAMITI</h2>
		<h4>Grain Purchase Receipt</h4>
	</div>

	<div class="doc-meta">
		<span><strong>Receipt No:</strong> {{ doc.name }}</span>
		<span><strong>Date:</strong> {{ frappe.format(doc.contract_date, {'fieldtype': 'Date'}) if doc.contract_date else '' }}</span>
		<span><strong>A/S:</strong> {{ doc.as_flag or '' }}</span>
	</div>

	<!-- Transaction & Farmer Details -->
	<div class="section-title">Transaction & Farmer Details</div>
	<table>
		<tr>
			<td class="label-cell">Transaction No</td>
			<td class="value-cell">{{ doc.transaction_no or '' }}</td>
			<td class="label-cell">Contract No</td>
			<td class="value-cell">{{ doc.contract_number or '' }}</td>
		</tr>
		<tr>
			<td class="label-cell">Farmer Name</td>
			<td class="value-cell">{{ doc.farmer_name or '' }}</td>
			<td class="label-cell">Phone</td>
			<td class="value-cell">{{ doc.phone_number or '' }}</td>
		</tr>
		<tr>
			<td class="label-cell">Address</td>
			<td class="value-cell">{{ doc.address or '' }}</td>
			<td class="label-cell">Vehicle No</td>
			<td class="value-cell">{{ doc.vehicle_number or '' }}</td>
		</tr>
		<tr>
			<td class="label-cell">Commodity (GSM)</td>
			<td class="value-cell" colspan="3"><strong>{{ doc.gsm or '' }}</strong></td>
		</tr>
	</table>

	<!-- Product Details -->
	<div class="section-title">Product & Calculation</div>
	<div class="two-col">
		<div class="col">
			<table>
				<tr>
					<td class="label-cell">KG per Bag</td>
					<td>{{ doc.kg_of_bag or 60 }}</td>
				</tr>
				<tr>
					<td class="label-cell">Expected Bags</td>
					<td>{{ doc.expected_bag or 0 }}</td>
				</tr>
				<tr>
					<td class="label-cell">Actual Bags</td>
					<td><strong>{{ doc.actual_bag or 0 }}</strong></td>
				</tr>
				<tr>
					<td class="label-cell">Nos KG</td>
					<td>{{ doc.nos_kg or 0 }}</td>
				</tr>
			</table>
		</div>
		<div class="col">
			<table>
				<tr>
					<td class="label-cell">Weight (Qtl)</td>
					<td><strong>{{ doc.actual_weight or 0 }}</strong></td>
				</tr>
				<tr>
					<td class="label-cell">Auction Rate</td>
					<td>{{ frappe.utils.fmt_money(doc.auction_rate, currency='INR') }}</td>
				</tr>
				<tr>
					<td class="label-cell">Amount</td>
					<td>{{ frappe.utils.fmt_money(doc.amount, currency='INR') }}</td>
				</tr>
				<tr>
					<td class="label-cell">Rounded Amount</td>
					<td><strong>{{ frappe.utils.fmt_money(doc.rounded_amount, currency='INR') }}</strong></td>
				</tr>
			</table>
		</div>
	</div>

	<!-- Hamali & Tax -->
	<div class="two-col" style="margin-top: 12px;">
		<div class="col">
			<div class="section-title">Hamali (Labor)</div>
			<table>
				<tr>
					<td class="label-cell">Hamali Rate</td>
					<td>{{ frappe.utils.fmt_money(doc.hamali_rate, currency='INR') }} {% if doc.hamali_rate_include %}(Included){% endif %}</td>
				</tr>
				<tr>
					<td class="label-cell">Hamali Amount</td>
					<td>{{ frappe.utils.fmt_money(doc.hamali, currency='INR') }}</td>
				</tr>
				<tr>
					<td class="label-cell"><strong>Net Amount</strong></td>
					<td><strong>{{ frappe.utils.fmt_money(doc.net_amount, currency='INR') }}</strong></td>
				</tr>
			</table>
		</div>
		<div class="col">
			<div class="section-title">Tax Deduction</div>
			<table>
				<tr>
					<td class="label-cell">Mandi Tax ({{ doc.mandi_tax_rate or 1 }}%)</td>
					<td>{{ frappe.utils.fmt_money(doc.mandi_tax, currency='INR') }}</td>
				</tr>
				<tr>
					<td class="label-cell">Nirashrit Tax ({{ doc.nirashrit_tax_rate or 0.2 }}%)</td>
					<td>{{ frappe.utils.fmt_money(doc.nirashrit_tax, currency='INR') }}</td>
				</tr>
				<tr>
					<td class="label-cell"><strong>Total Tax</strong></td>
					<td><strong>{{ frappe.utils.fmt_money(doc.total_tax, currency='INR') }}</strong></td>
				</tr>
			</table>
		</div>
	</div>

	<!-- Payment Details -->
	<div class="section-title">Payment Details</div>
	<table>
		<tr>
			<td class="label-cell">Payment Status</td>
			<td>
				{% set status_class = {
					'Paid': 'status-paid',
					'Pending': 'status-pending',
					'Partial': 'status-partial',
					'Cancelled': 'status-cancelled'
				} %}
				<span class="payment-status {{ status_class.get(doc.payment_status, 'status-pending') }}">
					{{ doc.payment_status or 'Pending' }}
				</span>
			</td>
			<td class="label-cell">Payment Date</td>
			<td>{{ frappe.format(doc.pay_date, {'fieldtype': 'Date'}) if doc.pay_date else '' }}</td>
		</tr>
		<tr>
			<td class="label-cell">Payment Mode</td>
			<td>{{ doc.payment_mode or '' }}</td>
			<td class="label-cell">Paid Amount</td>
			<td><strong>{{ frappe.utils.fmt_money(doc.paid_amount, currency='INR') if doc.paid_amount else '₹ 0.00' }}</strong></td>
		</tr>
		<tr>
			<td class="label-cell">Balance Amount</td>
			<td><strong style="color: {{ 'red' if (doc.balance_amount or 0) > 0 else 'green' }};">{{ frappe.utils.fmt_money(doc.balance_amount, currency='INR') if doc.balance_amount else '₹ 0.00' }}</strong></td>
			<td class="label-cell">Payment Details</td>
			<td>{{ doc.payment_details or '' }}</td>
		</tr>
	</table>

	{% if doc.bank_name or doc.account_number %}
	<!-- Bank Details -->
	<div class="section-title">Bank Details</div>
	<table>
		<tr>
			<td class="label-cell">Bank Name</td>
			<td>{{ doc.bank_name or '' }}</td>
			<td class="label-cell">Account No</td>
			<td>{{ doc.account_number or '' }}</td>
		</tr>
		<tr>
			<td class="label-cell">Branch</td>
			<td>{{ doc.branch or '' }}</td>
			<td class="label-cell">IFSC Code</td>
			<td>{{ doc.ifsc_code or '' }}</td>
		</tr>
	</table>
	{% endif %}

	<!-- Net Payable Amount Box -->
	<div class="amount-box">
		<div class="label">NET PAYABLE AMOUNT</div>
		<div class="value">{{ frappe.utils.fmt_money(doc.net_amount, currency='INR') }}</div>
		{% if doc.paid_amount and doc.balance_amount and doc.balance_amount > 0 %}
		<div style="font-size: 13px; color: red; margin-top: 5px;">
			Paid: {{ frappe.utils.fmt_money(doc.paid_amount, currency='INR') }} | Balance Due: {{ frappe.utils.fmt_money(doc.balance_amount, currency='INR') }}
		</div>
		{% elif doc.paid_amount and doc.payment_status == 'Paid' %}
		<div style="font-size: 13px; color: green; margin-top: 5px;">
			FULLY PAID
		</div>
		{% endif %}
	</div>

	<div class="signature-section">
		<div class="signature-box">
			<br><br><br>
			Farmer's Signature
		</div>
		<div class="signature-box">
			<br><br><br>
			Verified By
		</div>
		<div class="signature-box">
			<br><br><br>
			Authorized Signatory
		</div>
	</div>
</div>
